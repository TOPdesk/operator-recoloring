"function"==typeof SuppressedError&&SuppressedError;var t=function(){function t(t,s,e){this.r=0,this.g=0,this.b=0,this.set(t,s,e)}return t.prototype.set=function(t,s,e){this.r=this.clamp(t),this.g=this.clamp(s),this.b=this.clamp(e)},t.prototype.hueRotate=function(t){void 0===t&&(t=0),t=t/180*Math.PI;var s=Math.sin(t),e=Math.cos(t);this.multiply([.213+.787*e-.213*s,.715-.715*e-.715*s,.072-.072*e+.928*s,.213-.213*e+.143*s,.715+.285*e+.14*s,.072-.072*e-.283*s,.213-.213*e-.787*s,.715-.715*e+.715*s,.072+.928*e+.072*s])},t.prototype.grayscale=function(t){void 0===t&&(t=1),this.multiply([.2126+.7874*(1-t),.7152-.7152*(1-t),.0722-.0722*(1-t),.2126-.2126*(1-t),.7152+.2848*(1-t),.0722-.0722*(1-t),.2126-.2126*(1-t),.7152-.7152*(1-t),.0722+.9278*(1-t)])},t.prototype.sepia=function(t){void 0===t&&(t=1),this.multiply([.393+.607*(1-t),.769-.769*(1-t),.189-.189*(1-t),.349-.349*(1-t),.686+.314*(1-t),.168-.168*(1-t),.272-.272*(1-t),.534-.534*(1-t),.131+.869*(1-t)])},t.prototype.saturate=function(t){void 0===t&&(t=1),this.multiply([.213+.787*t,.715-.715*t,.072-.072*t,.213-.213*t,.715+.285*t,.072-.072*t,.213-.213*t,.715-.715*t,.072+.928*t])},t.prototype.multiply=function(t){var s=this.clamp(this.r*t[0]+this.g*t[1]+this.b*t[2]),e=this.clamp(this.r*t[3]+this.g*t[4]+this.b*t[5]),r=this.clamp(this.r*t[6]+this.g*t[7]+this.b*t[8]);this.r=s,this.g=e,this.b=r},t.prototype.brightness=function(t){void 0===t&&(t=1),this.linear(t)},t.prototype.contrast=function(t){void 0===t&&(t=1),this.linear(t,-.5*t+.5)},t.prototype.linear=function(t,s){void 0===t&&(t=1),void 0===s&&(s=0),this.r=this.clamp(this.r*t+255*s),this.g=this.clamp(this.g*t+255*s),this.b=this.clamp(this.b*t+255*s)},t.prototype.invert=function(t){void 0===t&&(t=1),this.r=this.clamp(255*(t+this.r/255*(1-2*t))),this.g=this.clamp(255*(t+this.g/255*(1-2*t))),this.b=this.clamp(255*(t+this.b/255*(1-2*t)))},t.prototype.hsl=function(){var t=this.r/255,s=this.g/255,e=this.b/255,r=Math.max(t,s,e),a=Math.min(t,s,e),i=0,o=(r+a)/2;if(r===a)return{h:0,s:0,l:100*o};var n=r-a;return r===t?i=(s-e)/n+(s<e?6:0):r===s?i=(e-t)/n+2:r===e&&(i=(t-s)/n+4),{h:100*(i/=6),s:100*(o>.5?n/(2-r-a):n/(r+a)),l:100*o}},t.prototype.clamp=function(t){return Math.min(Math.max(t,0),255)},t}(),s=function(){function s(s,e){this.target=s,this.targetHSL=s.hsl(),this.options=Object.assign({},{acceptanceLossPercentage:5,maxChecks:15},e),this.reusedColor=new t(0,0,0)}return s.prototype.solve=function(){var t=this.solveNarrow(this.solveWide());return{values:t.values,called:t.called,loss:t.loss,filter:this.css(t.values)}},s.prototype.solveWide=function(){for(var t=[60,180,18e3,600,1.2,1.2],s={loss:1/0},e=0;s.loss>this.options.acceptanceLossPercentage;){var r=this.spsa({A:5,a:t,c:15,values:[50,20,3750,50,100,100],maxTriesInLoop:1e3});if(r.loss<s.loss&&(s=r),(e+=1)>=this.options.maxChecks)break}return Object.assign({},s,{called:e})},s.prototype.solveNarrow=function(t){var s=t.loss,e=s+1,r=[.25*e,.25*e,e,.25*e,.2*e,.2*e];return this.spsa({A:s,a:r,c:2,values:t.values,maxTriesInLoop:500,called:t.called})},s.prototype.fixValueByFilterIDX=function(t,s){var e=100;return 2===s?e=7500:4!==s&&5!==s||(e=200),3===s?t>e?t%=e:t<0&&(t=e+t%e):t<0?t=0:t>e&&(t=e),t},s.prototype.spsa=function(t){for(var s=t.A,e=t.a,r=t.c,a=t.values,i=t.maxTriesInLoop,o=void 0===i?500:i,n=t.called,h=void 0===n?0:n,l=null,c=1/0,p=new Array(6),u=new Array(6),v=new Array(6),f=0;f<o;f++){for(var g=r/Math.pow(f+1,.16666666666666666),y=0;y<6;y++)p[y]=Math.random()>.5?1:-1,u[y]=a[y]+g*p[y],v[y]=a[y]-g*p[y];var m=this.loss(u)-this.loss(v);for(y=0;y<6;y++){var d=m/(2*g)*p[y],b=e[y]/Math.pow(s+f+1,1);a[y]=this.fixValueByFilterIDX(a[y]-b*d,y)}var x=this.loss(a);x<c&&(l=a.slice(0),c=x)}return{values:l,loss:c,called:h}},s.prototype.loss=function(t){var s=this.reusedColor;s.set(0,0,0),s.invert(t[0]/100),s.sepia(t[1]/100),s.saturate(t[2]/100),s.hueRotate(3.6*t[3]),s.brightness(t[4]/100),s.contrast(t[5]/100);var e=s.hsl();return Math.abs(s.r-this.target.r)+Math.abs(s.g-this.target.g)+Math.abs(s.b-this.target.b)+Math.abs(e.h-this.targetHSL.h)+Math.abs(e.s-this.targetHSL.s)+Math.abs(e.l-this.targetHSL.l)},s.prototype.css=function(t){var s=function(s,e){return void 0===e&&(e=1),Math.round(t[s]*e)};return["invert("+s(0)+"%)","sepia("+s(1)+"%)","saturate("+s(2)+"%)","hue-rotate("+s(3,3.6)+"deg)","brightness("+s(4)+"%)","contrast("+s(5)+"%);"].join(" ")},s}(),e=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},r={},a=function(a,i){var o,n,h,l,c,p;if(void 0===i&&(i={}),r[a]&&!i.forceFilterRecalculation)return Object.assign({},r[a],{cache:!0});try{if(n=(o=function(t,s){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,a,i=e.call(t),o=[];try{for(;(void 0===s||s-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(t){a={error:t}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(a)throw a.error}}return o}(4===(p=a).length?[parseInt("0x"+p[1]+p[1]),parseInt("0x"+p[2]+p[2]),parseInt("0x"+p[3]+p[3])]:7===p.length?[parseInt("0x"+p[1]+p[2]),parseInt("0x"+p[3]+p[4]),parseInt("0x"+p[5]+p[6])]:[],3))[0],h=o[1],l=o[2],!e(n)||!e(h)||!e(l))throw new Error("hextToRgb returned an invalid value for '"+a+"'");c=new t(Number(n),Number(h),Number(l))}catch(t){throw new Error("Color value should be in HEX format. "+t)}var u=new s(c,Object.assign({},{acceptanceLossPercentage:5,maxChecks:30,forceFilterRecalculation:!1},i));return r[a]=Object.assign({},u.solve(),{hex:a,rgb:[n,h,l],cache:!1})};const i={acceptanceLossPercentage:1,maxChecks:1e4};self.onmessage=t=>{try{const s={...i,forceFilterRecalculation:t.data.clearCache},e=a(t.data.color,s);self.postMessage(e)}catch(t){self.postMessage({error:t.message})}};
